---
title: "Fitting periodic mortality models for WAH and NWT herds"
author: "Peter Thompson"
date: "April 5, 2019"
output: html_document
---

###WAH (Western Arctic Herd) Data - Two-Season Periodic Mortality Analysis

The Western Arctic Herd of caribou is expected to have a mortality cycle with two seasons of especially high mortality. We test our periodic mortality fitting approach on this dataset expecting the "selectNSeasons" function to identify the two-season model as the most accurate fit.

```{r}
data(wah_morts)
wah_morts = wah_morts[wah_morts$end < "2017-01-01",]#taking out weird years of 2017 and 2018
wah_surv = createCycloSurv(data = wah_morts$interval, censoring = wah_morts$Fate == "DEAD", period = 365)
listOfFits = selectNSeasons(T = wah_surv, max.season = 4)
for (i in 1:5) {
  plot(listOfFits[[i]])
}
```

###NWT (Northwest Territories Herd) Data - Three-Season Periodic Mortality Analysis

Boreal forest caribou from the Northwest Territories is expected to have a mortality cycle with three seasons of especially high mortality. We test our periodic mortality fitting approach on this dataset expecting the "selectNSeasons" function to identify the three-season model as the most accurate fit.

```{r}
data(nwt_morts)
nwt_surv = createCycloSurv(data = nwt_morts$interval, censoring = nwt_morts$Fate == "DEAD", period = 365)
listOfFits = selectNSeasons(T = nwt_surv, max.season = 4)
for (i in 1:5) {
  plot(listOfFits[[i]])
}
```