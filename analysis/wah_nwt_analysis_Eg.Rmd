---
title: "Fitting periodic mortality models for WAH and NWT herds"
author: "Peter Thompson"
date: "April 5, 2019"
output: html_document
---


Load package:

```{r}
require(cyclomort)
```


###WAH (Western Arctic Herd) Data - Two-Season Periodic Mortality Analysis

The Western Arctic Herd of caribou is expected to have a mortality cycle with two seasons of especially high mortality. We test our periodic mortality fitting approach on this dataset expecting the `selectNSeasons` function to identify the two-season model as the most accurate fit.

```{r}
data(wah_morts)
require(lubridate)
require(mutate)
with(subset(wah_morts, Fate == "DEAD"), hist(yday(end)))
#require(ggplot2)
#ggplot(wah_morts, aes(end))
```

```{r}
wah_surv = createCycloSurv(data = wah_morts$interval, censoring = wah_morts$Fate == "DEAD", period = 365)
listOfFits = selectNSeasons(T = wah_surv, max.season = 4)
for (i in 1:5)  plot(listOfFits[[i]])


list(
  NullModel = fit_cyclomort(wah_surv, n.seasons = 0),
  OneSeason = fit_cyclomort(wah_surv, n.seasons = 1),
  TwoSeasons = fit_cyclomort(wah_surv, n.seasons = 2),
  ThreeSeasons = fit_cyclomort(wah_surv, n.seasons = 3),
  FourSeasons = fit_cyclomort(wah_surv, n.seasons = 4))


 ThreeSeasons = fit_cyclomort(wah_surv, n.seasons = 3, method = "Nelder-Mead")
  FourSeasons = fit_cyclomort(wah_surv, n.seasons = 4)
```

###NWT (Northwest Territories Herd) Data - Three-Season Periodic Mortality Analysis

Boreal forest caribou from the Northwest Territories is expected to have a mortality cycle with three seasons of especially high mortality. We test our periodic mortality fitting approach on this dataset expecting the "selectNSeasons" function to identify the three-season model as the most accurate fit.

```{r}
data(nwt_morts)
nwt_surv = createCycloSurv(data = nwt_morts$interval, censoring = nwt_morts$Fate == "DEAD", period = 365)
listOfFits = selectNSeasons(T = nwt_surv, max.season = 4)
for (i in 1:5) {
  plot(listOfFits[[i]])
}
```